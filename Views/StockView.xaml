<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:helpers="clr-namespace:signals.Helpers"
             xmlns:models="clr-namespace:signals.Models"
             xmlns:f="clr-namespace:Fonts"
             x:Class="signals.Views.StockView"
             x:DataType="models:StockItem">
    <ContentView.Resources>
        <helpers:ValueToColorConverter x:Key="ValueToColorConverter"/>
        <helpers:ProgressToColorConverter x:Key="ProgressToColorConverter"/>
    </ContentView.Resources>
    <ScrollView HorizontalOptions="Fill"
                VerticalOptions="Fill"
                Padding="10,0,10,0">
        <Border Stroke="#252e3d"
                HorizontalOptions="Fill"
                VerticalOptions="Fill"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 10,10,10,10"
                BackgroundColor="#18202e"
                Padding="10"
                Margin="5">
            <Grid  HorizontalOptions="Fill"
                   VerticalOptions="Fill"
                   WidthRequest="300"
                   RowSpacing="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="150"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Label Text="Trend Strength:"
                       FontSize="16"
                       FontAttributes="Bold"
                       HorizontalOptions="Start"
                       Grid.Row="0"
                       Grid.ColumnSpan="2"/>

                <Label Text="{Binding TrendStrength}"
                       FontSize="16"
                       FontAttributes="Bold"
                       Grid.Row="0"
                       Grid.Column="2"
                       HorizontalOptions="End"/>

                <Label Text="Mean Rev"
                       TextColor="Gray"
                       Grid.Row="1"
                       Grid.Column="0"
                       HorizontalOptions="Start"/>

                <Label Text="Random"
                       TextColor="Gray"
                       Grid.Row="1"
                       Grid.Column="1"
                       HorizontalOptions="Center"/>

                <Label Text="Trending"
                       TextColor="Gray"
                       Grid.Row="1"
                       Grid.Column="2"
                       HorizontalOptions="End"/>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="2"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Text="{Binding Symbol}"
                       FontSize="28"
                       FontAttributes="Bold"
                       HorizontalOptions="Start"
                       Grid.Row="3"
                       Grid.ColumnSpan="2"
                       Margin="0,5,0,0"/>

                <Label Text="{Binding Symbol, StringFormat='{} ${0}'}"
                       FontSize="20"
                       TextColor="#555555"
                       LineBreakMode="TailTruncation"
                       HorizontalOptions="Start"
                       Grid.Row="4"
                       Grid.ColumnSpan="2"
                       Margin="-5,0,5,5"/>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="5"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Text="{Binding Price, StringFormat='${0:N2}'}"
                       FontSize="28"
                       FontAttributes="Bold"
                       HorizontalOptions="Start"
                       Grid.Row="6"
                       Grid.ColumnSpan="3"/>


                <Label FontSize="16"
                       Grid.Row="7"
                       Grid.ColumnSpan="3">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="{Binding PriceChangeDisplay}"
                                  FontSize="16"
                                  TextColor="{Binding PriceChangeColor}"/>
                            <Span Text=" 1 hr"
                                  FontSize="16"
                                  TextColor="#FF6D6D6D"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <Label FontSize="16"
                       Grid.Row="8"
                       Grid.ColumnSpan="3">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="{Binding PriceChangeDisplay}"
                                  FontSize="16"
                                  TextColor="{Binding PriceChangeColor}"/>
                            <Span Text=" Today"
                                  FontSize="16"
                                  TextColor="#FF6D6D6D"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="9"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="10"
                       Grid.ColumnSpan="3"
                       FontSize="32">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="{x:Static f:FluentUI.circle_32_regular}"
                                  FontFamily="FluentUI"
                                  TextColor="{Binding PriceChangeColor}"/>
                            <Span Text="    "/>
                            <Span Text="{x:Static f:FluentUI.arrow_up_right_32_regular}"
                                  FontFamily="FluentUI"
                                  TextColor="{Binding PriceChangeColor}"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="11"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="12"
                       Text="Price"
                       TextColor="#FF6D6D6D"
                       Grid.Column="0"
                       FontSize="18"/>

                <HorizontalStackLayout Grid.Row="12"
                                       Grid.Column="3"
                                       Spacing="5"
                                       HorizontalOptions="End">
                    <Button Text="D"
                            HorizontalOptions="Center"
                            VerticalOptions="Start"
                            WidthRequest="10"
                            HeightRequest="10"/>
                    <Button Text="M"
                            HorizontalOptions="Center"
                            VerticalOptions="Start"/>
                </HorizontalStackLayout>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="13"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Text="{Binding PatternDisplay}"
                       TextColor="{Binding PatternDisplayColor}"
                       FontSize="24"
                       FontAttributes="Bold"
                       HorizontalOptions="Start"
                       Grid.Row="14"
                       Grid.ColumnSpan="3"/>

                <Label Grid.Row="15"
                       Text="Market Regime"
                       TextColor="#FF6D6D6D"
                       Grid.ColumnSpan="3"
                       Margin="0,15,0,0"
                       FontSize="18"/>

                <Label Grid.Row="16"
                       Text="{Binding MarketRegime}"
                       TextColor="{Binding MarketRegimeColor}"
                       Grid.ColumnSpan="3"
                       FontSize="24"/>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="17"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="18"
                       Text="Position Sizing"
                       TextColor="#FF6D6D6D"
                       Grid.ColumnSpan="3"
                       FontSize="18"/>

                <Label Grid.Row="19"
                       Text="Base Size"
                       TextColor="#FF6D6D6D"
                       Grid.Column="0"
                       FontSize="18"/>

                <Label Grid.Row="19"
                       Text="Adjusted"
                       HorizontalOptions="Start"
                       TextColor="#FF6D6D6D"
                       Grid.Column="3"
                       FontSize="18"/>

                <Label Grid.Row="20"
                       Text="{Binding BaseSize}"
                       Grid.Column="0"
                       FontSize="20"/>

                <Label Grid.Row="20"
                       Text="{Binding AdjustedSize}"
                       HorizontalOptions="Start"
                       Grid.Column="3"
                       FontSize="20"/>

                <Label Grid.Row="21"
                       Grid.ColumnSpan="3">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Risk Factor : "
                                  FontSize="20"
                                  TextColor="#FF6D6D6D"/>
                            <Span Text="{Binding RiskFactor}"
                                  FontSize="20"/>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="22"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="23"
                       Text="Enhanced Analysis"
                       TextColor="#FF6D6D6D"
                       Grid.ColumnSpan="3"
                       FontSize="18"/>

                <Label Grid.Row="24"
                       Text="{Binding EnhancedAnalysis}"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       FontSize="20"/>

                <Label Grid.Row="24"
                       Text="{Binding EnhancedAnalysisValue}"
                       TextColor="{Binding EnhancedAnalysisValue,Converter={StaticResource ValueToColorConverter}}"
                       Grid.Column="3"
                       HorizontalOptions="End"
                       FontSize="20"/>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="25"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="26"
                       Text="Market Analysis"
                       TextColor="#FF6D6D6D"
                       Grid.ColumnSpan="3"
                       FontSize="18"/>

                <Label Grid.Row="27"
                       Text="SPY Correlation"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       FontSize="20"/>

                <Label Grid.Row="27"
                       Text="{Binding SpyCorrelation}"
                       TextColor="{Binding SpyCorrelation,Converter={StaticResource ValueToColorConverter}}"
                       Grid.Column="3"
                       HorizontalOptions="End"
                       FontSize="20"/>

                <Label Grid.Row="28"
                       Text="Sector Exposure"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       FontSize="20"/>

                <Label Grid.Row="28"
                       Text="{Binding SectorExposure}"
                       TextColor="{Binding SectorExposure,Converter={StaticResource ValueToColorConverter}}"
                       Grid.Column="3"
                       HorizontalOptions="End"
                       FontSize="20"/>

                <BoxView HorizontalOptions="Fill"
                         VerticalOptions="Start"
                         Margin="-10,10,-10,10"
                         Grid.Row="29"
                         Grid.ColumnSpan="3"
                         HeightRequest="1"
                         BackgroundColor="#252e3d"/>

                <Label Grid.Row="30"
                       Text="Signal Strength"
                       TextColor="#FF6D6D6D"
                       Grid.ColumnSpan="3"
                       FontSize="18"/>

                <Label Grid.Row="31"
                       Text="Confidence"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       FontSize="20"/>

                <Label Grid.Row="31"
                       Text="{Binding Confidence}"
                       TextColor="{Binding Confidence,Converter={StaticResource ValueToColorConverter}}"
                       Grid.Column="3"
                       HorizontalOptions="End"
                       FontSize="20"/>

                <ProgressBar Grid.Row="32"
                             Grid.ColumnSpan="3"
                             Progress="{Binding Confidence}"
                             HeightRequest="10"
                             BackgroundColor="#252e3d"
                             ProgressColor="{Binding Confidence,Converter={StaticResource ProgressToColorConverter}}"/>

            </Grid>
        </Border>
    </ScrollView>

</ContentView>
